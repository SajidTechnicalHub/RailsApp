<%= form_for([@product, @rating],remote:true)  do |form| %>
  <% if rating.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(rating.errors.count, "error") %> prohibited this rating from being saved:</h2>

      <ul>
      <% rating.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="rateyo" id= "rating"
           data-rateyo-rating="0"
           data-rateyo-num-stars="5"
           data-rateyo-score="3"></div>
      <span class='score'>0</span>
      <span class='result'>0</span>
      <input type="text" name="rating">
  </div>



  <div id="rating-form">
    <%= form.label :rating %>
    
  </div>

  <div class="field">
    <%= form.label :comment %>
    <%= form.text_area :comment %>
  </div>


  <div class="actions">
    <%= form.submit %>
  </div>
<% end %>

<script>
  $('#rating-form').raty({
    path: '/assets/',
    scoreName: "rating[rating]"

  });
</script>

<script>
  $(function () {
      $(".rateyo").rateYo().on("rateyo.change", function (e, data) {
          var rating = data.rating;
          $(this).parent().find('.score').text('score :'+ $(this).attr('data-rateyo-score'));
          $(this).parent().find('.result').text('rating :'+ rating);
          $(this).parent().find('input[name=rating]').val(rating); //add rating value to input field
      });
  });
</script>